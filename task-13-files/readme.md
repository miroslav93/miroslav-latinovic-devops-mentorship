# Task 13 Reproduction Notes

## Environment setup
- Introduction to AWS Code Family
- Goal: Deploy a simple Java application
- AWS CodeCommit - Git repository to store code
- AWS CodeArtifact - Manage software packages
- AWS CodeBuild - compile the Java app
- AWS CodeDeploy - Deploy app to an EC2 server
- AWS CodePipeline - orchestrate the process
- Repro steps:
1. Created a Cloud9 Environment
2. Installed Apache Maven on the new work environment
3. Installed Amazon Corretto 8
4. Verified Maven and Java are installed
5. Used Maven to generate sample Java web app
6. Modified the sample web app to include custom code

## Lab 1 - CodeCommit
1. Initiated a git repo on the Cloud9 environment
2. Configured remote origin to be the CodeCommit repo
3. Commited changes to Java web app code
4. Pushed those changes to CodeCommit repo

## Lab 2 - CodeArtifact
- Goal: Set up a CodeArtifact repo as a simple package cache
- In case the package repository becomes unavailable, the app will still be able to build using this cache
1. Created CodeArtifact domain
2. Created CodeArtifact repository
3. Connected Cloud9 environment with CodeArtifact repository
4. Configured settings.xml to facilitate Clod9 and CodeArtifact connection
5. Tested building the Java app using the newly created settings.xml config
6. Created IAM policy to let other services consume CodeArtifact repository

## Lab 3 - CodeBuild
- Goal: Set up a CodeBuild project to package our Unicorn Java app into a Java Web Application Archive (WAR) file
1. Created miroslav-mentorship-unicorn-build-artifacts S3 bucket to store the output from CodeBuild
2. Created CodeBuild Project
3. Configured runtime settings for the CodeBuild project
4. Created buildpec.yml file with build configuration and pushed it to CodeCommit repo
5. Modified the autogenerated codebuild role by attaching the previously created IAM CodeArtifact policy to it
5. Triggered the newly created build
6. Build reported that it finished sucessfully
7. Extracted the file from the S3 bucket and confirmed that the WAR file was created successfully

## Lab 4 - CodeDeploy
- Goal: Install the previously built Java WAR on an EC2 instance using CodeDeploy
1. Created the EC2 instance and all the required resources using the provided CloudFormation stack template
2. Created three script files for CodeDeploy to use for server configuration and starting/stopping - install_dependencies.sh, start_server.sh and stop_server.sh
3. Created appspec.yml that specifies actions taken during deployment
4. Updated build specification file to include script files
5. Committed all the new changes
6. Created IAM Role for CodeBuild
7. Created CodeDeploy application
8. Created a deployment group and added the EC2 instance to it using role - webserver tag
9. Created deployment for the application
10. Confirmed basic placeholder HTML is now available on the provisioned EC2 instance

## Lab 5 - CodePipeline
- Goal: Create an automated pipeline using CodePipeline and integrate the previous CodeCommit, CodeBuild and CodeDeploy components into it
1. Created a new CodePipeline pipeline and added all the previously created components to it
2. Triggered the initial pipeline release
3. Source, Build and Deploy stages report success
4. Updated the website index file with new HTML code
5. Downloaded the background image and uploaded it through Code9 to the repo
6. Comitted changes to CodeCommit which automatically triggered the pipeline
7. Pipeline reports success again
8. Updated website now available at http://3.67.180.80/